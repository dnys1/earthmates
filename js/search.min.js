function loadPrevious(){if($(".previous>a").disable(!0),$(".next>a").disable(!0),page>0){page--;var e=page*resultsPerPage;console.log(page),console.log(e),rows.empty();for(var r=0;r<rows.length;r++){var s=results[e+r],o="";o+="<td>",o+='<img src="profile_image.php?id='+s.ID+'" class="img-responsive" />',o+="</td>",parseInt(s.GlobalProfile)?(o+='<td><a href="view_profile.php?id='+s.ID+'">'+s.FirstName+" "+s.LastName+"</a></td>",o+='<td class="results-score">'+(s.AvgScore?s.AvgScore.toFixed(1):"N/A")+"</td>"):(o+='<td title="This user does not allow others to view their EarthMates profile.">'+s.FirstName+" "+s.LastName+"</td>",o+='<td title="This user does not allow others to view their EarthMates profile.">N/A</td>'),rows[r].innerHTML=o}blocks=$(".results-score"),scores=[];for(var r=0;r<blocks.length;r++)scores[r]=parseFloat(blocks[r].innerText);colorScores(),page>0&&$(".previous>a").disable(!1),$(".next>a").disable(!1)}}function loadNext(){if($(".previous>a").disable(!0),$(".next>a").disable(!0),pageCount>page){page++;var e,r=page*resultsPerPage;e=r+rows.length<=results.length?rows.length:results.length-r,console.log(page),console.log(r),console.log(e),rows.empty();for(var s=0;e>s;s++){var o=results[r+s],t="";t+="<td>",t+='<img id="image'+s+'" src="profile_image.php?id='+o.ID+'" class="img-responsive" />',t+="</td>",parseInt(o.GlobalProfile)?(t+='<td><a href="view_profile.php?id='+o.ID+'">'+o.FirstName+" "+o.LastName+"</a></td>",t+='<td class="results-score">'+(o.AvgScore?o.AvgScore.toFixed(1):"N/A")+"</td>"):(t+='<td title="This user does not allow others to view their EarthMates profile.">'+o.FirstName+" "+o.LastName+"</td>",t+='<td title="This user does not allow others to view their EarthMates profile.">N/A</td>'),rows[s].innerHTML=t}blocks=$(".results-score"),scores=[];for(var s=0;s<blocks.length;s++)scores[s]=parseFloat(blocks[s].innerText);colorScores(),pageCount>page&&$(".next>a").disable(!1),$(".previous>a").disable(!1)}}function resizeImage(e){var r=document.getElementById(e),s=r.clientHeight,o=r.clientWidth;if(o>s){var t=s/5,a=Math.round((o-4*t)/2);$(r).css("clip-path","inset(0 "+a+"px 0 "+a+"px)")}else var t=o/4}function roundScore(e){return 4.8>=e?parseInt(e):5}function colorScores(){$(".results-score").empty(),minWidth=12,maxWidth=$(".results-score").width(),width=d3.scaleLinear().domain([0,5]).range([minWidth,maxWidth]),blocks=d3.selectAll(".results-score").data(scores).append("div").classed("bar-other",!0),50>maxWidth&&console.log("Too small!"),blocks.style("width",function(e){return width(e)+"px"}).style("background-color",function(e){var r=roundScore(e);return otherLevelColors[r]}).text(function(e){return e}),blocks.append("div").classed("marker",!0).style("width",maxWidth+"px").style("border-color",function(e){var r=roundScore(e);return otherLevelColors[r]}).text(function(e){return 5==roundScore(e)?"":"5"})}var page=0,rows,resultsPerPage,pageCount,blocks,scores=[];$(document).ready(function(){if(results&&(results=JSON.parse(results),resultsPerPage=5,pageCount=Math.floor(results.length/resultsPerPage),rows=$(".search-table>tbody>tr"),$(".previous>a").disable(!0),results.length<=5&&$(".next>a").disable(!0),$(".previous>a").on("click",loadPrevious),$(".next>a").on("click",loadNext),$(".results-score").length>0)){blocks=$(".results-score");for(var e=0;e<blocks.length;e++)scores[e]=parseFloat(blocks[e].innerText);colorScores(),$(window).on("resize",colorScores),window.addEventListener("orientationchange",colorScores,!1)}});var otherLevelColors=["rgb(253, 187, 45)","rgb(209, 188, 75)","rgb(165, 189, 105)","rgb(121, 191, 135)","rgb(77, 192, 165)","rgb(34, 193, 195)"],selfLevelColors=["rgba(253, 187, 45, 0.6)","rgba(209, 188, 75, 0.6)","rgba(165, 189, 105, 0.6)","rgba(121, 191, 135, 0.6)","rgba(77, 192, 165, 0.6)","rgba(34, 193, 195, 0.6)"],width,minWidth,maxWidth,blocks;jQuery.fn.extend({disable:function(e){return this.each(function(){this.disabled=e})}});